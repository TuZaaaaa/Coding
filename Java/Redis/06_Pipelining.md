# Pipelining
> 一次性发送多条命令给服务器端，依次处理完后，通过一条响应一次性将结果返回
> 通过减少客户端与 redis 的通信次数来实现降低往返延迟


- 如何优化频繁命令往返造成的性能瓶颈？

1. client 向 server 发送命令（发送命令 > 命令排队 > 命令执行 > 返回结果），并监听 socket 返回，通常以阻塞模式等待服务端响应
2. 服务端处理命令，并将结果返回给客户端
3. 如果同时需要执行大量命令，需要等待上一条命令应答后执行，中间不仅多了 RTT，还频繁调用系统 IO，发送网络请求，数据从用户态转换为内核态，性能不好

> RTT: Round Trip Time 数据包往返于两端的时间


## 与原生批量命令对比
- 原生批量命令是**原子性**的，pipeline 是**非原子性**的
- 原生批量命令一次只能执行一种类型命令，pipeline 支持多种
- 原生批量命令 服务端实现，pipeline 需要服务端和客户端共同完成

## 与事务对比
- 执行事务会阻塞其他命令的执行，执行 pipeline 中的命令不会