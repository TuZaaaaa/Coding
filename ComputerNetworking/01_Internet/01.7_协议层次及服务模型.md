# 协议层次及服务模型

## 协议层次

- 如何组织和实现复杂的网络功能？
  - 分层
    - 相邻层之间可以互相调用，不推荐跨层调用
    - eg: 异地哲学家交流：秘书层：负责异地通讯，翻译层：负责信息转换，哲学家层：信息的交换

### 层次化方式实现复杂网络功能

- 将网络复杂的功能分层功能明确的**层次**，每一层实现了其中一个或一组**功能**，功能中有其上层可以使用的功能：**服务**
- 本层协议实体相互交互执行本层的**协议动作**，目的是实现本层的功能，通过接口为上层提供更好的服务
- 在实现本层协议的时候，直接**利用了下层所提供的服务**
- 本层的服务：借助下层服务实现的本层协议实体之间交互带来的新功能（上层可以利用的）更下层所提供的服务


## 服务

- 服务（Service）：低层实体向上层实体提供它们之间的通信的能力
  - 服务用户（service user）
  - 服务提供者（service provider）
- 原语（primitive）：上层使用下层服务的形式，高层使用低层提供的服务，以及低层向高层提供服务都是通过服务访问原语来进行交互的形式
- 服务访问点 SAP(Servicec Access point)：上层使用下层提供的服务通过层间的接口

### 服务的类型

- 面向连接的服务（Connection-oriented Service）
  - 连接：两个通信实体为进行通信而建立的一种结合
  - 通信过程：建立连接，通信，拆除连接
  - eg：网络层的连接被成为虚电路
  - 适用范围：大的数据块要传输，不适合小的零星报文
  - 特点：保序
  - 场景
    - 可靠的信息流 传送页面（可靠的获得，通过接收方的确认）
    - 可靠的字节流 远程登录
    - 不可靠的连接 数字化声音
- 无连接的服务（Connectionless Service）
  - 两个对等层实体在通信前不需要建立一个连接，不预留资源，不需要通信双方都是活跃
  - 特点：不可靠、可能重复、可能失序
  - 适用范围：传输零星数据
  - 场景
    - 不可靠的数据报 电子方式的函件
    - 有确认的数据报 挂号信
    - 请求回答 信息查询

### 服务和协议
- 服务与协议的区别
  - 服务（Service）：低层实体向上层实体提供它们之间的通信的能力，通过原语(primitive)来操作，**垂直**
  - 协议（Protocal）：对等层实体(peer entity)之间项目通信的过程中，需要遵循的规则的集合，**水平**
- 服务与协议的联系
  - 本层**协议的实现**要靠下层提供的服务来实现
  - 本层实体通过协议上层**提供更高级的服务**

## 协议栈
- 应用层：网络应用
  - FTP, SMTP, HTTP, DNS
  - PDU: 报文（message）
- 传输层：主机之间的数据传输
  - 进程之间的通信，不可靠 -> 可靠
  - TCP, UDP
  - PDU: 报文段（segment）
- 网络层：为数据报从源主机到目标主机选择路由
  - 主机之间的通信，端到端通信，不可靠
  - IP(转发)，路由协议
  - PDU: 分组（packet）无连接：数据报 datagram
- 链路层：相邻网络节点间的数据传输
  - 可靠/不可靠
  - 点对点协议PPP，802.11(wifi), Ethernet
  - PDU: 帧（frame）
- 物理层：在线路上传输 bit，将 bit 转换为物理信号（光信号，电磁波等）
  - PDU: 位（bit）

- OSI 模型 以下两层位于应用层之下，但实际在应用层实现
  - 表示层：允许应用解释传输的数据
    - 加密，压缩，机器相关的表示转换
  - 会话层：数据交换的同步，检查点，恢复
