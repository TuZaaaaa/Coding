# 网络核心
> 路由器的网状网络

## 电路交换
> **端到端**的资源被分配到**源端**到**目标端**的呼叫 "call"

- 带宽分片
  - 频分 Frequency-division-multiplexing
  - 时分 Time-division-multiplexing
  - 波分 Wave-division-multiplexing
  - 为呼叫分配片
  - 如果某个呼叫没有数据，则其资源片处于**空闲状态**
- 独享资源：不共享
  - 每个呼叫一旦建立起来就能够保证性能
- 如果呼叫没有数据发送，被分配的资源就会被浪费 no sharing
- 通常被传统电话网络采用
- 不适合计算机之间的通信
  - 连接建立时间长
  - 计算机之间的通信有突发性，如果使用线路交换，浪费的片较多
  - 可靠性不高？

## 分组交换
- 将要传送的数据分成一个个单位：分组 packet
- 将分组从一个路由传到相邻路由器（hop），一段段最终从源端到目标端
- 存储 转发：分组每次移动一跳（hop）
  - 在转发之前，节点必须收到整个分组
  - 延迟比线路交换高
  - 排队时间 到达速率 > 链路输出速率
    - 分组将会排队，等待传输
    - 路由器缓存用尽，分组将会被抛弃
- 资源共享，按需使用
- 每段：采用链路的最大传输能力（带宽）
- 统计多路复用
  - 特殊的时分复用
- 按照有无网络层的连接，进行分类
  - 数据报网络（无网络层）
    - 分组的目标地址决定下一跳
    - 在不同的阶段，路由可以改变
    - 在通信之前，无需建立连接，有数据就能传输
    - 每个分组都有独立路由（路径不一样，可能会失序）
    - 路由器根据分组的目标地址进行路由
  - 虚电路网络 Virtual Circuit
    - 通过信令构建
    - 每个分组都带标签（虚电路标识 VCID），标签决定下一跳
    - 在**呼叫建立**时决定路径，在整个呼叫中路径保持不变
    - **路由器维持每个呼叫的状态信息**
    - X.25/ATM


## 分组交换 VS 电路交换
> 同样的网络资源，分组交换允许更多用户使用网络

- 1 Mb/s 链路
- 每个用户
  - 活动时：100 kb/s
  - 10% 的时间是活动的
- 电路交换
  - 10 个用户
- 分组交换
  - 35 用户时
  - $>=10$ 个用户活动的概率为 0.0004
  - $$1-\sum_{n=0}^{9}(n=35)p^n(1-p)^{35-n}$$

- 分组交换 
  - 适用于突发式数据传输
    - 资源共享
    - 简单，不必建立呼叫
  - 过度使用会造成网络拥塞：分组延时和丢失
    - 对可靠地数据传输需要协议来约束：拥塞控制
  - 提供类似电路交换的服务？
    - 保证音频/视频应用需要的带宽
    - 一个仍未解决的问题（chapter 7）